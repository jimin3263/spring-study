# ì»´í¬ë„ŒíŠ¸ ìŠ¤ìº”

## ì»´í¬ë„ŒíŠ¸ ìŠ¤ìº”ê³¼ ì˜ì¡´ê´€ê³„ ìë™ ì£¼ì…
- `@Bean`ì„ ì‚¬ìš©í•´ì„œ ë¹ˆì„ ë“±ë¡í•œë‹¤ë©´ ë“±ë¡í•˜ëŠ” ë¹ˆì˜ ê°¯ìˆ˜ê°€ ë§ì•„ì§„ë‹¤ë©´ ë²ˆê±°ë¡œìš´ ì‘ì—…ì´ ë¨
- ê·¸ë˜ì„œ ìŠ¤í”„ë§ì€ ì„¤ì • ì •ë³´ ì—†ì´ ìë™ìœ¼ë¡œ ìŠ¤í”„ë§ ë¹ˆì„ ë“±ë¡í•˜ëŠ” ì»´í¬ë„ŒíŠ¸ ìŠ¤ìº”ì„ ì œê³µí•¨
- ì˜ì¡´ ê´€ê³„ë„ ìë™ìœ¼ë¡œ ì£¼ì…í•˜ëŠ” `@Autowired`ë¼ëŠ” ê¸°ëŠ¥ë„ ì œê³µí•¨

```java
@Configuration
@ComponentScan(
        excludeFilters = @ComponentScan.Filter(type = FilterType.ANNOTATION, classes = Configuration.class)
)
public class AutoAppConfig {

}
```
- **`@ComponentScan`ì„ ì‚¬ìš©í•˜ë©´ `@Component`ê°€ ë¶™ì€ í´ë˜ìŠ¤ë¥¼ ë¹ˆìœ¼ë¡œ ë“±ë¡**í•˜ëŠ”ë° AppConfig ë“± ì•ì„œ ë§Œë“  configë“¤ë„ ë“±ë¡ë˜ê¸° ë•Œë¬¸ì— `excludeFilters`ë¥¼ ì‚¬ìš©í•¨
-  ì˜ì¡´ê´€ê³„ëŠ” `@Autowired`ë¡œ ì„¤ì •í•¨

> AutoAppConfigTest

```java
public class AutoAppConfigTest {

    @Test
    void basicScan(){
        //given
        AnnotationConfigApplicationContext ac = new AnnotationConfigApplicationContext(AutoAppConfig.class);

        //when
        MemberService memberService = ac.getBean(MemberService.class);
        Assertions.assertThat(memberService).isInstanceOf(MemberService.class);
    }
}
```
### ì •ë¦¬

**1. @ComponentScan**
- `@ComponentScan`ì€ `@Component`ê°€ ë¶™ì€ ëª¨ë“  í´ë˜ìŠ¤ë¥¼ ë¹ˆìœ¼ë¡œ ë“±ë¡í•¨
- ê¸°ë³¸ì ìœ¼ë¡œ í´ë˜ìŠ¤ ëª…ì„ ì‚¬ìš©í•˜ë©° ë§¨ ì•ê¸€ìë¥¼ ì†Œë¬¸ìë¡œ ë°”ê¿”ì„œ ì´ë¦„ì„ ë“±ë¡í•˜ì§€ë§Œ `@Component("memberService2")`ì´ë¦„ ë¶€ì—¬ ê°€ëŠ¥  

**2. @Autowired ì˜ì¡´ê´€ê³„ ìë™ ì£¼ì…**
- `@Autowired`ë¥¼ ì§€ì •í•˜ë©´ ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆê°€ ìë™ìœ¼ë¡œ ë¹ˆì„ ì°¾ì•„ì¤Œ
- íƒ€ì…ì´ ê°™ì€ ë¹ˆì„ ì°¾ì•„ì„œ ì£¼ì…í•¨
- == getBean(MemberRepository.class)

## íƒìƒ‰ ìœ„ì¹˜ì™€ ê¸°ë³¸ ìŠ¤ìº” ëŒ€ìƒ
- ëª¨ë“  ìë°” í´ë˜ìŠ¤ë¥¼ ì»´í¬ë„ŒíŠ¸ ìŠ¤ìº”í•œë‹¤ë©´ ì‹œê°„ì´ ì˜¤ë˜ ê±¸ë¦¬ë¯€ë¡œ íƒìƒ‰ ì‹œì‘ ìœ„ì¹˜ë¥¼ ì§€ì •í•  ìˆ˜ ìˆìŒ

```java
@ComponentScan(
          basePackages = "hello.core",
}
```
- ì§€ì •í•˜ì§€ ì•Šì•˜ë‹¤ë©´ `@ComponentScan`ì´ ë¶™ì€ ì„¤ì • ì •ë³´ í´ë˜ìŠ¤ì˜ íŒ¨í‚¤ì§€ê°€ ìŠ¤ìº” ì‹œì‘ ìœ„ì¹˜ê°€ ë¨
- ì„¤ì • ì •ë³´ í´ë˜ìŠ¤ì˜ ìœ„ì¹˜ë¥¼ í”„ë¡œì íŠ¸ ìµœìƒë‹¨ì— ë‘ëŠ” ê²ƒì„ ê¶Œì¥í•¨
- `@SpringBootApplication`ì•ˆì— `@ComponentScan`ì´ ë“¤ì–´ìˆìŒ

### ì»´í¬ë„ŒíŠ¸ ìŠ¤ìº” ê¸°ë³¸ ëŒ€ìƒ

- `@Component` : ì»´í¬ë„ŒíŠ¸ ìŠ¤ìº”ì—ì„œ ì‚¬ìš©
- `@Controlller` : ìŠ¤í”„ë§ MVC ì»¨íŠ¸ë¡¤ëŸ¬ì—ì„œ ì‚¬ìš©
- `@Service` : ìŠ¤í”„ë§ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì—ì„œ ì‚¬ìš©
- `@Repository` : ìŠ¤í”„ë§ ë°ì´í„° ì ‘ê·¼ ê³„ì¸µì—ì„œ ì‚¬ìš©, ìŠ¤í”„ë§ ë°ì´í„° ì ‘ê·¼ ê³„ì¸µìœ¼ë¡œ ì¸ì‹í•˜ê³  ë°ì´í„° ê³„ì¸µì˜ ì˜ˆì™¸ë¥¼ ìŠ¤í”„ë§ ì˜ˆì™¸ë¡œ ë³€í™˜í•´ì¤Œ
- `@Configuration` : ìŠ¤í”„ë§ ì„¤ì • ì •ë³´ì—ì„œ ì‚¬ìš©, ì‹±ê¸€í†¤ì„ ìœ ì§€í•˜ë„ë¡ í•´ì¤Œ

## í•„í„°
`@ComponentScan`ì˜ ì†ì„±ì¤‘ì— íŠ¹ì • ë¹ˆì„ ë“±ë¡í•˜ê±°ë‚˜ ë“±ë¡í•˜ì§€ ì•Šë„ë¡ í•  ìˆ˜ ìˆìŒ
- **includeFilters**: ì»´í¬ë„ŒíŠ¸ ìŠ¤ìº” ëŒ€ìƒì„ ì¶”ê°€ë¡œ ì§€ì •í•œë‹¤.
- **excludeFilters**: ì»´í¬ë„ŒíŠ¸ ìŠ¤ìº”ì—ì„œ ì œì™¸í•  ëŒ€ìƒì„ ì§€ì •í•œë‹¤

> Filter Test
```java
public class ComponentFilterAppConfigTest {

    @Test
    void filterScan(){
        ApplicationContext ac = new AnnotationConfigApplicationContext(ComponentFilterAppConfig.class);
        //include
        BeanA beanA = ac.getBean("beanA",BeanA.class);
        Assertions.assertThat(beanA).isNotNull();

        //exclude
        //BeanB beanB = ac.getBean("beanB",BeanB.class);
        org.junit.jupiter.api.Assertions.assertThrows(
                NoSuchBeanDefinitionException.class,
                () -> ac.getBean("beanB",BeanB.class));
    }

    @Configuration
    @ComponentScan(
            includeFilters = @ComponentScan.Filter(type = FilterType.ANNOTATION, classes = MyIncludeConponent.class),
            excludeFilters = @ComponentScan.Filter(type = FilterType.ANNOTATION, classes = MyExcludeComponent.class)
    )
    static class ComponentFilterAppConfig{

    }
}
```

### FilterType ì˜µì…˜

- **ANNOTATION**: ê¸°ë³¸ê°’, ì• ë…¸í…Œì´ì…˜ì„ ì¸ì‹í•´ì„œ ë™ì‘
- **ASSIGNABLE_TYPE**: ì§€ì •í•œ íƒ€ì…ê³¼ ìì‹ íƒ€ì…ì„ ì¸ì‹í•´ì„œ ë™ì‘

```java
@ComponentScan(
    includeFilters = {
        @Filter(type = FilterType.ANNOTATION, classes = MyIncludeComponent.class),
    },
    excludeFilters = {
        @Filter(type = FilterType.ANNOTATION, classes = MyExcludeComponent.class),
        @Filter(type = FilterType.ASSIGNABLE_TYPE, classes = BeanA.class)
    }
)
```
- BeanAë„ ì œì™¸í•˜ê³  ì‹¶ìœ¼ë©´ ìœ„ì™€ ê°™ì´ ì‘ì„±

## ì¤‘ë³µ ë“±ë¡ê³¼ ì¶©ëŒ
: ì»´í¬ë„ŒíŠ¸ ìŠ¤ìº”ì—ì„œ ê°™ì€ ë¹ˆ ì´ë¦„ì„ ë“±ë¡í•œë‹¤ë©´?ğŸ§

### ìë™ ë¹ˆ ë“±ë¡ vs ìë™ ë¹ˆ ë“±ë¡
- ì»´í¬ë„ŒíŠ¸ ìŠ¤ìº”ì— ì˜í•´ ìë™ìœ¼ë¡œ ìŠ¤í”„ë§ ë¹ˆì´ ë“±ë¡ë˜ëŠ”ë°, ê·¸ ì´ë¦„ì´ ê°™ì€ ê²½ìš° ìŠ¤í”„ë§ì€ ì˜¤ë¥˜ ë°œìƒ
- `ConflictingBeanDefinitionException` ì˜ˆì™¸ ë°œìƒ

### ìˆ˜ë™ ë¹ˆ ë“±ë¡ vs ìë™ ë¹ˆ ë“±ë¡
```java
@Component
public class MemoryMemberRepository implements MemberRepository{}
```

```java
@Configuration
@ComponentScan(
    excludeFilters = @Filter(type = FilterType.ANNOTATION, classes = Configuration.class)
)
public class AutoAppConfig {
    
    @Bean(name = "memoryMemberRepository")
    public MemberRepository memberRepository() {
        return new MemoryMemberRepository();
    }
}
```
- ìˆ˜ë™ ë¹ˆì´ ìš°ì„  ìˆœìœ„ê°€ ë†’ìŒ(ìˆ˜ë™ ë¹ˆì´ ìë™ ë¹ˆì„ ì˜¤ë²„ë¼ì´ë”©)
- ìŠ¤í”„ë§ ë¶€íŠ¸ëŠ” ìˆ˜ë™ ë¹ˆ ë“±ë¡ê³¼ ìë™ ë¹ˆ ë“±ë¡ì´ ì¶©ëŒë‚˜ë©´ ì˜¤ë¥˜ë‚˜ë„ë¡ ê¸°ë³¸ ê°’ì„ ë°”ê¿¨ìŒ
